{"name":"Demixing and deconvolution of calcium imaging data","tagline":"Matlab implementation of a source extraction and spike inference algorithm for large scale calcium imaging data analysis, based on a constrained matrix factorization approach.","body":"# Deconvolution and demixing of calcium imaging data\r\n\r\n[![Join the chat at https://gitter.im/epnev/ca_source_extraction](https://badges.gitter.im/Join%20Chat.svg)](https://gitter.im/epnev/ca_source_extraction?utm_source=badge&utm_medium=badge&utm_campaign=pr-badge&utm_content=badge)\r\n\r\nThe code implements a method for simultaneous source extraction and spike inference from large scale calcium imaging movies. The code is suitable for the analysis of somatic imaging data. Implementation for the analysis of dendritic/axonal imaging data will be added in the future. \r\n\r\nThe algorithm is presented in more detail in\r\n\r\nPnevmatikakis, E.A., Soudry, D., Gao, Y., Machado, T., Merel, J., ... & Paninski, L. (2016). Simultaneous denoising, deconvolution, and demixing of calcium imaging data. Neuron, in press, http://dx.doi.org/10.1016/j.neuron.2015.11.037\r\n\r\nPnevmatikakis, E.A., Gao, Y., Soudry, D., Pfau, D., Lacefield, C., ... & Paninski, L. (2014). A structured matrix factorization framework for large scale calcium imaging data analysis. arXiv preprint arXiv:1409.2903. http://arxiv.org/abs/1409.2903\r\n\r\nCode description and related packages\r\n=======\r\n\r\nThis repository contains a MATLAB implementation of the spatio-temporal demixing, i.e., (source extraction) code for large scale calcium imaging data. Related code can be found in the following links:\r\n\r\n## Matlab \r\n- [Constrained deconvolution for neural activity (spike) extraction](https://github.com/epnev/constrained-foopsi)\r\n- [Source extraction (this package)](https://github.com/epnev/ca_source_extraction)\r\n- [MCMC spike inference](https://github.com/epnev/continuous_time_ca_sampler)\r\n- [Group LASSO initialization](https://github.com/danielso/ROI_detect)\r\n\r\n## Python\r\n- [Constrained deconvolution for neural activity (spike) extraction](https://github.com/epnev/constrained_foopsi_python)\r\n- [Source extraction](https://github.com/agiovann/SOURCE_EXTRACTION_PYTHON)\r\n- [Group LASSO initialization](https://github.com/danielso/ROI_detect)\r\n\r\n## Integration with other libraries\r\n- [SIMA](http://www.losonczylab.org/sima/1.3/): The [constrained deconvolution](https://github.com/losonczylab/sima/blob/master/sima/spikes.py) method has been integrated with SIMA, a Python based library for calcium imaging data analysis.\r\n- [Thunder](http://thunder-project.org/): The [group LASSO initialization](https://github.com/j-friedrich/thunder/tree/LocalNMF) method has been integrated with Thunder, a library for large scale neural data analysis with Spark.\r\n\r\n\r\nUsage and Documentation\r\n=======\r\nCheck the demo scripts and documentation.pdf to get started.\r\n\r\nDependencies\r\n============\r\n\r\nThe following matlab toolboxes are needed for the default parameter settings:\r\n- Statistics and Machine Learning Toolbox\r\n- Image processing toolbox\r\n\r\nDepending on the settings the following toolboxes may also be required\r\n- Signal processing toolbox (recommended but not required)\r\n- Parallel computing toolbox (recommended for large datasets but not required)\r\n- Optimization toolbox (not required)\r\n\r\nThe default options for the algorithm require the following packages:\r\n\r\n1. The constrained deconvolution package maintained separately in https://github.com/epnev/constrained-foopsi \r\n2. The CVX library which can be downloaded from http://cvxr.com/cvx/download/ (follow the installation instructions provided there) \r\n\r\nDepending on the settings the following packages may also be required\r\n- SPGL1 package from https://github.com/mpf/spgl1 (for solving constrained_foopsi using SPGL1)\r\n- Bayesian spike inference package from https://github.com/epnev/continuous_time_ca_sampler (for using the 'MCMC\" deconvolution method).\r\n\r\nQuestions, comments, issues\r\n=======\r\nPlease use the gitter chat room (use the button above) for questions and comments and create an issue for any bugs you might encounter.\r\n\r\nLicense\r\n=======\r\n\r\nThis program is free software; you can redistribute it and/or\r\nmodify it under the terms of the GNU General Public License\r\nas published by the Free Software Foundation; either version 2\r\nof the License, or (at your option) any later version.\r\n\r\nThis program is distributed in the hope that it will be useful,\r\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\r\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\nGNU General Public License for more details.\r\n\r\nYou should have received a copy of the GNU General Public License\r\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n\r\n[//]: #  (function name                           | description )\r\n[//]: #  (----------------------------------------|-----------------------------------)\r\n[//]: #  (demo_script.m                           | wrapper code <br />)\r\n[//]: #  (demoMovie.tif                           | Sample dataset for running the code (by W. Yang and D. Peterka) <br />)\r\n[//]: #  (update_spatial_components.m             | update spatial components given temporal components and data <br />)\r\n[//]: #  (update_temporal_components.m            | update temporal components given spatial components and data <br />)\r\n[//]: #  (merge_ROIs.m                            | merge spatially overlapping components that are temporally correlated <br />)\r\n[//]: #  (utilities/arpfit.m                      | estimation of noise level for every pixel and global time constants <br />)\r\n[//]: #  (utilities/bigread2.m                    | read (parts of) large tiff stacks)\r\n[//]: #  (utilities/com.m:                        | calculation of the center of mass of each component <br />)\r\n[//]: #  (utilities/correlation_image.m           | calculates the correlation image of the movie <br />)\r\n[//]: #  (utilities/extract_DF_F.m                | transforming the temporal components in the DF/F domain <br />)\r\n[//]: #  (utilities/graph_connected_comp.m        | finds the connected components in a graph <br />)\r\n[//]: #  (utilities/greedyROI2d.m                 | Greedy method for initializing the spatial and temporal components <br />)\r\n[//]: #  (utilities/interp_missing_data.m         | Filling in missing data using linear interpolation <br />)\r\n[//]: #  (utilities/lars_regression_noise.m       | solve a basis pursuit denoising problem using the LARS algorithm <br />)\r\n[//]: #  (utilities/make_G_matrix.m               | construct a convolution/deconvolution matrix <br />)\r\n[//]: #  (utilities/make_patch_video.m            | construct a video that displays the results of the algorithm <br />)\r\n[//]: #  (utilities/order_ROIs.m                  | order found components based on their temporal activation and spatial size <br />)\r\n[//]: #  (utilities/plain_foopsi.m                | projection of fluorescence onto the cone formed by the indicator dynamics )\r\n[//]: #  (utilities/plot_contours.m               | contour plot of found components and creation of a json file <br />)\r\n[//]: #  (utilities/tiff_reader.m                 | loading a tiff stack into matlab <br />)\r\n[//]: #  (utilities/threshold_components.m        | mild post-processing of spatial components <br />)\r\n[//]: #  (utilities/view_patches.m                | plotting of each found component and its temporal activation <br />)\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}